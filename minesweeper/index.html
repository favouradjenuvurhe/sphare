<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mines â€” Uncover Gems Carefully</title>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

<!-- Tailwind -->
<script src="https://cdn.tailwindcss.com"></script>
<script>
  tailwind.config = {
    theme: {
      extend: {
        colors: {
          ssBg: "#0C0A16",
          ssCard: "#151226",
          ssBlue: "#4F9EFF",
          ssRed: "#FF6F61",
          successGreen: "#28a745",
          errorRed: "#dc3545",
          infoBlue: "#0d6efd"
        },
        fontFamily: { sans: ["Inter", "system-ui"] }
      }
    }
  }
</script>

<!-- Vue 3 -->
<script src="https://unpkg.com/vue@3.4.21/dist/vue.global.prod.js"></script>

<style>
body { background: #0C0A16; color: #fff; font-family: Inter, sans-serif; }
.card { background: #151226; border: 1px solid rgba(255,255,255,0.05); }
.grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; margin-top:10px; } /* 4 columns */
.cell { width: 60px; height: 60px; background: rgba(255,255,255,0.05); border-radius: 8px; display:flex; align-items:center; justify-content:center; font-size:1.5rem; cursor:pointer; transition: background 0.3s; }
.cell.gem { background: #FFD700; color: #000; font-weight:bold; }
.cell.mine { background: #FF6F61; color: #fff; font-weight:bold; }
.cell.revealed { cursor: default; }
button:disabled { opacity: 0.5; cursor: not-allowed; }

/* Grid card styling */
.grid-card { background: #151226; border: 1px solid rgba(255,255,255,0.05); padding: 1.5rem; border-radius: 1rem; }
</style>
</head>
<body>
<div id="app" class="min-h-screen p-6 pb-28 max-w-3xl mx-auto relative">

  <!-- Header -->
  <div class="flex items-center justify-between mb-6">
    <div>
      <div class="text-2xl font-semibold">Mines</div>
      <div class="text-sm text-gray-400">Uncover gems carefully!</div>
    </div>
  </div>

  <!-- Notification -->
  <transition name="fade">
    <div v-if="notification.message" :class="['card p-4 rounded-xl mb-6 font-medium', notificationColor]">
      {{ notification.message }}
    </div>
  </transition>

  <!-- Mines Grid Card -->
  <div class="grid-card text-center mb-6 shadow-lg">
    <div class="text-lg font-semibold mb-4">Gems: {{ gemsFound }} | Multiplier: {{ multiplier.toFixed(2) }}x</div>
    <div class="grid">
      <div v-for="(cell,index) in grid" :key="index"
           :class="['cell', cell.revealed ? (cell.type==='gem'?'gem':'mine') : '', cell.revealed?'revealed':'']"
           @click="revealCell(index)">
        <span v-if="cell.revealed">{{ cell.type==='gem' ? 'ðŸ’Ž' : 'ðŸ’£' }}</span>
      </div>
    </div>
  </div>

  <!-- Bet Amount -->
  <div class="card p-5 rounded-2xl shadow-lg mb-6">
    <label class="text-gray-300 text-sm">Enter Bet Amount (â‚¦)</label>
    <input type="number" v-model="betAmount" min="100"
           class="mt-2 w-full p-3 rounded-xl bg-ssBg border border-gray-700 focus:border-ssBlue outline-none"
           placeholder="e.g. 500" />

    <div class="flex gap-3 mt-4">
      <button v-if="!roundStarted && !roundOver" @click="startRound"
              class="flex-1 py-3 rounded-full bg-ssBlue text-black font-semibold flex items-center justify-center gap-2">
        Start Game
      </button>
      <button v-if="roundStarted && gemsFound>0" @click="cashOut"
              class="flex-1 py-3 rounded-full bg-successGreen text-black font-semibold flex items-center justify-center gap-2">
        Cash Out
      </button>
      <button v-if="roundOver" @click="newRound"
              class="flex-1 py-3 rounded-full bg-infoBlue text-white font-semibold flex items-center justify-center gap-2">
        New Round
      </button>
    </div>

    <div class="text-xs text-gray-400 mt-3">Min bet: â‚¦100 â€¢ Gems increase multiplier â€¢ Hit a mine = lose everything</div>
  </div>

</div>

<script>
const { createApp } = Vue;
createApp({
  data() {
    return {
      token: "",
      betAmount: "",
      roundStarted: false,
      roundOver: false,
      grid: Array(24).fill().map(()=>({type:'empty', revealed:false})), // 6x4
      gemsFound: 0,
      multiplier: 1,
      notification: { message:'', type:'info' }
    };
  },
  computed: {
    notificationColor() {
      return this.notification.type === "success" ? "bg-successGreen" : this.notification.type === "error" ? "bg-errorRed" : "bg-infoBlue";
    },
  },
  mounted() {
    this.token = localStorage.getItem("casino_token") || "DEMO_TOKEN";
  },
  methods: {
    showNotification(msg,type='info'){
      this.notification.message = msg;
      this.notification.type = type;
      setTimeout(()=>{ if(this.notification.message===msg) this.notification.message=''; },4000);
    },
    startRound(){
      if(!this.betAmount || Number(this.betAmount)<100) return this.showNotification('Enter valid bet (min â‚¦100)','error');
      this.roundStarted = true;
      this.roundOver = false;
      this.gemsFound = 0;
      this.multiplier = 1;

      // Reset grid
      this.grid = Array(24).fill().map(()=>({type:'gem', revealed:false}));

      // Place mines (~75% = 18 mines)
      let mineIndices = Array.from({length:24},(_,i)=>i);
      for(let i=0;i<18;i++){
        let idx = mineIndices.splice(Math.floor(Math.random()*mineIndices.length),1)[0];
        this.grid[idx].type = 'mine';
      }

      this.showNotification('Debiting walletâ€¦','info');
    },
    revealCell(index){
      if(this.roundOver || this.grid[index].revealed) return;
      this.grid[index].revealed = true;
      if(this.grid[index].type==='mine'){
        this.showNotification('ðŸ’¥ Mine hit! You lost your bet.','error');
        this.grid.forEach(c=>c.revealed=true); // reveal all
        this.roundStarted=false;
        this.roundOver=true;
      } else {
        this.gemsFound++;
        this.multiplier = 1 + this.gemsFound * 0.5;
      }
    },
    cashOut(){
      if(this.gemsFound===0 || this.roundOver) return;
      const winAmount = Number(this.betAmount) * this.multiplier;
      this.showNotification(`ðŸŽ‰ You cashed out â‚¦${winAmount.toFixed(2)}!`,'success');
      this.roundOver = true;
      this.roundStarted = false;
    },
    newRound(){
      this.roundStarted=false;
      this.roundOver=false;
      this.gemsFound=0;
      this.multiplier=1;
      this.grid = Array(24).fill().map(()=>({type:'empty', revealed:false}));
      this.showNotification('Ready for new round â€” place your bet!','info');
    }
  }
}).mount('#app');
</script>

<style>
.fade-enter-active, .fade-leave-active { transition: opacity .4s; }
.fade-enter-from, .fade-leave-to { opacity: 0; }
</style>
</body>
</html>
